import{S as ie,i as re,s as ue,e as p,k as q,c as v,a as I,m as U,d as T,b as a,J as te,g as G,K as r,W as j,X as ae,Y as de,Z as ce,_ as _e,$ as fe,a0 as le,T as he,t as me,V as pe,h as ve,a1 as be,p as ge,q as Te,o as ye,a2 as Ee,a3 as ne,n as ke,a4 as qe,L as Ue}from"../../chunks/vendor-ee294e9e.js";import{r as Ne}from"../../chunks/singletons-a6a7384f.js";const we=Ie;async function Ie(u){const{href:t}=new URL(u,location.href);return Ne.renderer.invalidate(t)}function J(u,{pending:t,error:e,result:o}={}){let m;async function y(c){const d=m={};c.preventDefault();const h=new FormData(u);t&&t({data:h,form:u});try{const l=await fetch(u.action,{method:u.method,headers:{accept:"application/json"},body:h});if(d!==m)return;if(l.ok){o&&o({data:h,form:u,response:l});const b=new URL(u.action);b.search=b.hash="",we(b.href)}else e?e({data:h,form:u,error:null,response:l}):console.error(await l.text())}catch(l){if(e)e({data:h,form:u,error:l,response:null});else throw l}}return u.addEventListener("submit",y),{destroy(){u.removeEventListener("submit",y)}}}function oe(u,t,e){const o=u.slice();return o[3]=t[e],o[4]=t,o[5]=e,o}function se(u,t){let e,o,m,y,c,d,h,l,b,P,M,F,f,E,s,i,n,O,x,N,K,w,R,A,W,D,H,S,X,L,Y,Z=Ue,k,z,Q;function $(...g){return t[1](t[3],t[4],t[5],...g)}function ee(){return t[2](t[3],t[4],t[5])}return{key:u,first:null,c(){e=p("div"),o=p("form"),m=p("input"),c=q(),d=p("input"),l=q(),b=p("button"),F=q(),f=p("form"),E=p("input"),i=q(),n=p("input"),x=q(),N=p("button"),K=q(),w=p("form"),R=p("input"),W=q(),D=p("button"),X=q(),this.h()},l(g){e=v(g,"DIV",{class:!0});var _=I(e);o=v(_,"FORM",{action:!0,method:!0});var B=I(o);m=v(B,"INPUT",{type:!0,name:!0,class:!0}),c=U(B),d=v(B,"INPUT",{type:!0,name:!0,class:!0}),l=U(B),b=v(B,"BUTTON",{class:!0,"aria-label":!0}),I(b).forEach(T),B.forEach(T),F=U(_),f=v(_,"FORM",{class:!0,action:!0,method:!0});var C=I(f);E=v(C,"INPUT",{type:!0,name:!0,class:!0}),i=U(C),n=v(C,"INPUT",{"aria-label":!0,type:!0,name:!0,class:!0}),x=U(C),N=v(C,"BUTTON",{class:!0,"aria-label":!0}),I(N).forEach(T),C.forEach(T),K=U(_),w=v(_,"FORM",{action:!0,method:!0});var V=I(w);R=v(V,"INPUT",{type:!0,name:!0,class:!0}),W=U(V),D=v(V,"BUTTON",{class:!0,"aria-label":!0}),I(D).forEach(T),V.forEach(T),X=U(_),_.forEach(T),this.h()},h(){a(m,"type","hidden"),a(m,"name","uid"),m.value=y=t[3].uid,a(m,"class","svelte-dmxqmd"),a(d,"type","hidden"),a(d,"name","done"),d.value=h=t[3].done?"":"true",a(d,"class","svelte-dmxqmd"),a(b,"class","toggle svelte-dmxqmd"),a(b,"aria-label",P="Mark todo as "+(t[3].done?"not done":"done")),a(o,"action","/todos?_method=PATCH"),a(o,"method","post"),a(E,"type","hidden"),a(E,"name","uid"),E.value=s=t[3].uid,a(E,"class","svelte-dmxqmd"),a(n,"aria-label","Edit todo"),a(n,"type","text"),a(n,"name","text"),n.value=O=t[3].text,a(n,"class","svelte-dmxqmd"),a(N,"class","save svelte-dmxqmd"),a(N,"aria-label","Save todo"),a(f,"class","text svelte-dmxqmd"),a(f,"action","/todos?_method=PATCH"),a(f,"method","post"),a(R,"type","hidden"),a(R,"name","uid"),R.value=A=t[3].uid,a(R,"class","svelte-dmxqmd"),a(D,"class","delete svelte-dmxqmd"),a(D,"aria-label","Delete todo"),D.disabled=H=t[3].pending_delete,a(w,"action","/todos?_method=DELETE"),a(w,"method","post"),a(e,"class","todo svelte-dmxqmd"),te(e,"done",t[3].done),this.first=e},m(g,_){G(g,e,_),r(e,o),r(o,m),r(o,c),r(o,d),r(o,l),r(o,b),r(e,F),r(e,f),r(f,E),r(f,i),r(f,n),r(f,x),r(f,N),r(e,K),r(e,w),r(w,R),r(w,W),r(w,D),r(e,X),k=!0,z||(Q=[j(M=J.call(null,o,{pending:$})),j(J.call(null,f)),j(S=J.call(null,w,{pending:ee}))],z=!0)},p(g,_){t=g,(!k||_&1&&y!==(y=t[3].uid))&&(m.value=y),(!k||_&1&&h!==(h=t[3].done?"":"true"))&&(d.value=h),(!k||_&1&&P!==(P="Mark todo as "+(t[3].done?"not done":"done")))&&a(b,"aria-label",P),M&&ae(M.update)&&_&1&&M.update.call(null,{pending:$}),(!k||_&1&&s!==(s=t[3].uid))&&(E.value=s),(!k||_&1&&O!==(O=t[3].text)&&n.value!==O)&&(n.value=O),(!k||_&1&&A!==(A=t[3].uid))&&(R.value=A),(!k||_&1&&H!==(H=t[3].pending_delete))&&(D.disabled=H),S&&ae(S.update)&&_&1&&S.update.call(null,{pending:ee}),_&1&&te(e,"done",t[3].done)},r(){Y=e.getBoundingClientRect()},f(){de(e),Z(),ce(e,Y)},a(){Z(),Z=_e(e,Y,Ee,{duration:200})},i(g){k||(g&&fe(()=>{L||(L=le(e,ne,{start:.7},!0)),L.run(1)}),k=!0)},o(g){g&&(L||(L=le(e,ne,{start:.7},!1)),L.run(0)),k=!1},d(g){g&&T(e),g&&L&&L.end(),z=!1,he(Q)}}}function Pe(u){let t,e,o,m,y,c,d,h,l=[],b=new Map,P,M,F,f=u[0];const E=s=>s[3].uid;for(let s=0;s<f.length;s+=1){let i=oe(u,f,s),n=E(i);b.set(n,l[s]=se(n,i))}return{c(){t=q(),e=p("div"),o=p("h1"),m=me("Todos"),y=q(),c=p("form"),d=p("input"),h=q();for(let s=0;s<l.length;s+=1)l[s].c();this.h()},l(s){pe('[data-svelte="svelte-181o7gf"]',document.head).forEach(T),t=U(s),e=v(s,"DIV",{class:!0});var n=I(e);o=v(n,"H1",{});var O=I(o);m=ve(O,"Todos"),O.forEach(T),y=U(n),c=v(n,"FORM",{class:!0,action:!0,method:!0});var x=I(c);d=v(x,"INPUT",{name:!0,"aria-label":!0,placeholder:!0,class:!0}),x.forEach(T),h=U(n);for(let N=0;N<l.length;N+=1)l[N].l(n);n.forEach(T),this.h()},h(){document.title="Todos",a(d,"name","text"),a(d,"aria-label","Add todo"),a(d,"placeholder","+ tap to add a todo"),a(d,"class","svelte-dmxqmd"),a(c,"class","new svelte-dmxqmd"),a(c,"action","/todos"),a(c,"method","post"),a(e,"class","todos svelte-dmxqmd")},m(s,i){G(s,t,i),G(s,e,i),r(e,o),r(o,m),r(e,y),r(e,c),r(c,d),r(e,h);for(let n=0;n<l.length;n+=1)l[n].m(e,null);P=!0,M||(F=j(J.call(null,c,{result:Me})),M=!0)},p(s,[i]){if(i&1){f=s[0],ke();for(let n=0;n<l.length;n+=1)l[n].r();l=be(l,i,E,1,s,f,b,e,qe,se,null,oe);for(let n=0;n<l.length;n+=1)l[n].a();ge()}},i(s){if(!P){for(let i=0;i<f.length;i+=1)Te(l[i]);P=!0}},o(s){for(let i=0;i<l.length;i+=1)ye(l[i]);P=!1},d(s){s&&T(t),s&&T(e);for(let i=0;i<l.length;i+=1)l[i].d();M=!1,F()}}}const Me=async({form:u})=>{u.reset()};function Oe(u,t,e){let{todos:o}=t;const m=(c,d,h,{data:l})=>{e(0,d[h].done=!!l.get("done"),o)},y=(c,d,h)=>e(0,d[h].pending_delete=!0,o);return u.$$set=c=>{"todos"in c&&e(0,o=c.todos)},[o,m,y]}class Le extends ie{constructor(t){super();re(this,t,Oe,Pe,ue,{todos:0})}}export{Le as default};
